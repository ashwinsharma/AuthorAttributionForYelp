# Authorship Attribution on Yelp Dataset

In this project we are trying to match unlabeled review text with its author by learning their writing style from the labeled text written by the same author. This can be modeled as a multi-class single-label classification problem in Machine Learning. The final goal of this task is to identify the true author of a review based on their writing style from a learned Deep Learning or Statistical Machine Learning model.

**Google Drive Link to Project Directory**
https://drive.google.com/drive/folders/1T5qvywra1MRqtz_mcaDwJ4tMIHYtY89k?usp=sharing

# Directory Structure

AuthorshipAttribution
```
.
+-- data/
|   +-- review.json
|   +-- train_data.pickle
|	+-- test_data.pickle
|	+-- glove/
+-- src/
|   +-- dataset_preperation.ipynb
|   +-- ensemble-ngram.ipynb
|	+-- ensemble-tfidf.ipynb
|	+-- ...
|	+-- ...
+-- models/
|   +-- gru_models/
|   +-- gru-rnn-weights/
+-- README.md
```

# The Notebooks

## dataset_preparation.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=1O7RV_nVnVhji5bdmHD6pbcDp6F-OSd5h

Reads the review.json file from the data directory and prepares the training and testing datasets. These will be stored as pickle files in the data directory. This notebook must be run before running any other notebook, since all other notebooks use the train and test data generated by this notebook.

## vanilla_tfidf.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=1UAh5fCiZiafQsuHzYMCx6RzxSfJjmY4t

Uses the train and test data pickle files to train a Linear Support Vector Classifier with TF/IDF vectorization for each review. Achieved an accuracy of 90.8% and an F1 score of 90.0

## vanilla_tfidf_nltk.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=18RZ62uVG-ZnZ6kc_762q-1gGAzB-Lomt

Uses the train and test data pickle files to train a Linear Support Vector Classifier with TF/IDF vectorization for each review. In addition, the data is subject to preprocessing where, it is tokenized, the punctuations and stop-words are removed and each token is stemmed with the Porter Stemmer. We also use a Maximum Absolute Value scaler which translates each feature individually such that the maximal absolute value of each feature in the training set will be 1.0 . Achieved an accuracy of 77.2%

## RNN_GRU.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=196gIabSropysD1TVBM2gew24Kjt2Af78

Uses the train and test data pickle files to train 50 GRU-RNN models. We train one model per author for 50 authors. When predicting the authors, we run a test review against each of the 50 trained models and pick the author corresponding to the model that gave the least loss. Training these models took around 9h 40m on a Macbook Pro, and testing took a further 22h 40m. We have provided all the trained models and weights in the models directory. These can be loaded into keras as required. Achieved an accuracy of 94.8%

## RNN_GRU_predictions.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=1UetzKzSY4XzZM-0QfICxjRkscajd2dya

Due to the long training and testing times of the GRU-RNN notebook, we have prepared this notebook, which loads the author models from the models directory and predicts the author for a single test review chosen by the user. The review to be tested is set inside the notebook itself. This is for demonstration purpose only.

## ensemble-ngram.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=1ODVBvw0crv8K7N5y3lh1R3p-rg4Ka9Ke

This notebook trains multiple SVCs as part of a one vs rest classifier using ngrams as features. The features are vectorized using a CountVectorizer and scaled using the Maximum Absolute Value scaler. Achieved an accuracy of 99.6%

## ensemble-tfidf.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=16F76FfqMLd9A0cDkH5NdlhPIkWjnGpbb

This notebook trains multiple SVCs as part of a one vs rest classifier using TF/IDF vectors as features. The features are vectorized using a TfidfVectorizer and scaled using the Maximum Absolute Value scaler. The preprocessing steps are similar to vanilla_tfidf_nltk.ipynb . Achieved an accuracy of 95.8%

## ensemble-word2vec.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=1wuxNoIFBhytwv1U24Z4orC1DDVfTTkiS

This notebook trains multiple Logistic Regression models as part of a one vs rest classifier using word2vec vectors as features. We train a skip-gram word2gram model to get the embeddings for the text. We also concatenate that with TF/IDF vectors. Achieved an accuracy of 87.6%

## ensemble.ipynb

**Link to Colab Notebook**
https://drive.google.com/open?id=1mWi4s0CXUxdyxCift1941NDDOeEZs9bV

The ensemble model uses the three above mentioned models and the result of the ensemble model is the average of all the 3 models. Achieved an accuracy of 99.2%